{"ast":null,"code":"import{useContext,useRef}from\"react\";import{useHistory}from\"react-router-dom\";import useInput from\"../../hooks -validation/use-input\";import AuthContext from\"../../store/auth-context\";import classes from\"./ProfileForm.module.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var passwordValidation=function passwordValidation(value){return value.trim()!==\"\"&&value.trim().length>6;};var ProfileForm=function ProfileForm(){var newPasswordInputRef=useRef();var history=useHistory();var authCtx=useContext(AuthContext);var _useInput=useInput(passwordValidation),enteredPassword=_useInput.value,enteredPasswordIsValid=_useInput.isValid,passwordInputHasError=_useInput.hasError,passwordChangedHandler=_useInput.valueChangeHandler,passwordBlurHandler=_useInput.inputBlurHandler,resetPasswordInput=_useInput.reset;var formIsValid=false;if(enteredPasswordIsValid){formIsValid=true;}var submitHandler=function submitHandler(e){e.preventDefault();var enteredNewPassword=newPasswordInputRef.current.value;//Add Validation\nif(!enteredPasswordIsValid){return;}fetch(\"https://identitytoolkit.googleapis.com/v1/accounts:update?key=AIzaSyDPbHagJYUL0Xn2PNv753puWCvP6WNAVlY\",{method:\"POST\",body:JSON.stringify({idToken:authCtx.token,password:enteredNewPassword,returnSecure:false}),header:{\"Content-Type\":\"application/json\"}}).then(function(response){// Assumption: Always succeeded\nhistory.replace(\"/auth\");});resetPasswordInput();};return/*#__PURE__*/_jsxs(\"form\",{className:classes.form,onSubmit:submitHandler,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(classes.control,\" \").concat(!enteredPasswordIsValid&&classes.invalid),children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"new-password\",className:\"\".concat(!enteredPasswordIsValid&&classes.invalid),children:!enteredPasswordIsValid?\"Invalid Password\":\"New Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",minLength:\"7\",ref:newPasswordInputRef,id:\"new-password\",onChange:passwordChangedHandler,onBlur:passwordBlurHandler,value:enteredPassword}),passwordInputHasError&&/*#__PURE__*/_jsx(\"p\",{style:{color:\"#b40e0e\"},children:\"Password must not be empty or less than 7.\"})]}),/*#__PURE__*/_jsx(\"div\",{className:classes.action,children:/*#__PURE__*/_jsx(\"button\",{disabled:!formIsValid,children:\"Change Password\"})})]});};export default ProfileForm;","map":{"version":3,"names":["useContext","useRef","useHistory","useInput","AuthContext","classes","passwordValidation","value","trim","length","ProfileForm","newPasswordInputRef","history","authCtx","enteredPassword","enteredPasswordIsValid","isValid","passwordInputHasError","hasError","passwordChangedHandler","valueChangeHandler","passwordBlurHandler","inputBlurHandler","resetPasswordInput","reset","formIsValid","submitHandler","e","preventDefault","enteredNewPassword","current","fetch","method","body","JSON","stringify","idToken","token","password","returnSecure","header","then","response","replace","form","control","invalid","color","action"],"sources":["/home/albert/Desktop/combine-project/react-authentication/src/components/Profile/ProfileForm.js"],"sourcesContent":["import { useContext, useRef } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport useInput from \"../../hooks -validation/use-input\";\nimport AuthContext from \"../../store/auth-context\";\nimport classes from \"./ProfileForm.module.css\";\n\nconst passwordValidation = (value) => {\n  return value.trim() !== \"\" && value.trim().length > 6;\n};\n\nconst ProfileForm = () => {\n  const newPasswordInputRef = useRef();\n  const history = useHistory();\n\n  const authCtx = useContext(AuthContext);\n\n  const {\n    value: enteredPassword,\n    isValid: enteredPasswordIsValid,\n    hasError: passwordInputHasError,\n    valueChangeHandler: passwordChangedHandler,\n    inputBlurHandler: passwordBlurHandler,\n    reset: resetPasswordInput,\n  } = useInput(passwordValidation);\n\n  let formIsValid = false;\n\n  if (enteredPasswordIsValid) {\n    formIsValid = true;\n  }\n\n  const submitHandler = (e) => {\n    e.preventDefault();\n    const enteredNewPassword = newPasswordInputRef.current.value;\n\n    //Add Validation\n\n    if (!enteredPasswordIsValid) {\n      return;\n    }\n\n    fetch(\n      \"https://identitytoolkit.googleapis.com/v1/accounts:update?key=AIzaSyDPbHagJYUL0Xn2PNv753puWCvP6WNAVlY\",\n      {\n        method: \"POST\",\n        body: JSON.stringify({\n          idToken: authCtx.token,\n          password: enteredNewPassword,\n          returnSecure: false,\n        }),\n        header: {\n          \"Content-Type\": \"application/json\",\n        },\n      }\n    ).then((response) => {\n      // Assumption: Always succeeded\n\n      history.replace(\"/auth\");\n    });\n    resetPasswordInput();\n  };\n  return (\n    <form className={classes.form} onSubmit={submitHandler}>\n      <div\n        className={`${classes.control} ${\n          !enteredPasswordIsValid && classes.invalid\n        }`}\n      >\n        <label\n          htmlFor=\"new-password\"\n          className={`${!enteredPasswordIsValid && classes.invalid}`}\n        >\n          {!enteredPasswordIsValid ? \"Invalid Password\" : \"New Password\"}\n        </label>\n        <input\n          type=\"password\"\n          minLength=\"7\"\n          ref={newPasswordInputRef}\n          id=\"new-password\"\n          onChange={passwordChangedHandler}\n          onBlur={passwordBlurHandler}\n          value={enteredPassword}\n        />\n        {passwordInputHasError && (\n          <p style={{ color: \"#b40e0e\" }}>\n            Password must not be empty or less than 7.\n          </p>\n        )}\n      </div>\n      <div className={classes.action}>\n        <button disabled={!formIsValid}>Change Password</button>\n      </div>\n    </form>\n  );\n};\n\nexport default ProfileForm;\n"],"mappings":"AAAA,OAASA,UAAT,CAAqBC,MAArB,KAAmC,OAAnC,CACA,OAASC,UAAT,KAA2B,kBAA3B,CACA,MAAOC,SAAP,KAAqB,mCAArB,CACA,MAAOC,YAAP,KAAwB,0BAAxB,CACA,MAAOC,QAAP,KAAoB,0BAApB,C,wFAEA,GAAMC,mBAAkB,CAAG,QAArBA,mBAAqB,CAACC,KAAD,CAAW,CACpC,MAAOA,MAAK,CAACC,IAAN,KAAiB,EAAjB,EAAuBD,KAAK,CAACC,IAAN,GAAaC,MAAb,CAAsB,CAApD,CACD,CAFD,CAIA,GAAMC,YAAW,CAAG,QAAdA,YAAc,EAAM,CACxB,GAAMC,oBAAmB,CAAGV,MAAM,EAAlC,CACA,GAAMW,QAAO,CAAGV,UAAU,EAA1B,CAEA,GAAMW,QAAO,CAAGb,UAAU,CAACI,WAAD,CAA1B,CAEA,cAOID,QAAQ,CAACG,kBAAD,CAPZ,CACSQ,eADT,WACEP,KADF,CAEWQ,sBAFX,WAEEC,OAFF,CAGYC,qBAHZ,WAGEC,QAHF,CAIsBC,sBAJtB,WAIEC,kBAJF,CAKoBC,mBALpB,WAKEC,gBALF,CAMSC,kBANT,WAMEC,KANF,CASA,GAAIC,YAAW,CAAG,KAAlB,CAEA,GAAIV,sBAAJ,CAA4B,CAC1BU,WAAW,CAAG,IAAd,CACD,CAED,GAAMC,cAAa,CAAG,QAAhBA,cAAgB,CAACC,CAAD,CAAO,CAC3BA,CAAC,CAACC,cAAF,GACA,GAAMC,mBAAkB,CAAGlB,mBAAmB,CAACmB,OAApB,CAA4BvB,KAAvD,CAEA;AAEA,GAAI,CAACQ,sBAAL,CAA6B,CAC3B,OACD,CAEDgB,KAAK,CACH,uGADG,CAEH,CACEC,MAAM,CAAE,MADV,CAEEC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,CACnBC,OAAO,CAAEvB,OAAO,CAACwB,KADE,CAEnBC,QAAQ,CAAET,kBAFS,CAGnBU,YAAY,CAAE,KAHK,CAAf,CAFR,CAOEC,MAAM,CAAE,CACN,eAAgB,kBADV,CAPV,CAFG,CAAL,CAaEC,IAbF,CAaO,SAACC,QAAD,CAAc,CACnB;AAEA9B,OAAO,CAAC+B,OAAR,CAAgB,OAAhB,EACD,CAjBD,EAkBApB,kBAAkB,GACnB,CA7BD,CA8BA,mBACE,cAAM,SAAS,CAAElB,OAAO,CAACuC,IAAzB,CAA+B,QAAQ,CAAElB,aAAzC,wBACE,aACE,SAAS,WAAKrB,OAAO,CAACwC,OAAb,aACP,CAAC9B,sBAAD,EAA2BV,OAAO,CAACyC,OAD5B,CADX,wBAKE,cACE,OAAO,CAAC,cADV,CAEE,SAAS,WAAK,CAAC/B,sBAAD,EAA2BV,OAAO,CAACyC,OAAxC,CAFX,UAIG,CAAC/B,sBAAD,CAA0B,kBAA1B,CAA+C,cAJlD,EALF,cAWE,cACE,IAAI,CAAC,UADP,CAEE,SAAS,CAAC,GAFZ,CAGE,GAAG,CAAEJ,mBAHP,CAIE,EAAE,CAAC,cAJL,CAKE,QAAQ,CAAEQ,sBALZ,CAME,MAAM,CAAEE,mBANV,CAOE,KAAK,CAAEP,eAPT,EAXF,CAoBGG,qBAAqB,eACpB,UAAG,KAAK,CAAE,CAAE8B,KAAK,CAAE,SAAT,CAAV,wDArBJ,GADF,cA2BE,YAAK,SAAS,CAAE1C,OAAO,CAAC2C,MAAxB,uBACE,eAAQ,QAAQ,CAAE,CAACvB,WAAnB,6BADF,EA3BF,GADF,CAiCD,CApFD,CAsFA,cAAef,YAAf"},"metadata":{},"sourceType":"module"}