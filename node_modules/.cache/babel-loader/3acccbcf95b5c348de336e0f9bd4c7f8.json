{"ast":null,"code":"import _regeneratorRuntime from\"/home/albert/Desktop/combine-project/react-authentication/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/albert/Desktop/combine-project/react-authentication/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/albert/Desktop/combine-project/react-authentication/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Fragment,useContext,useState}from\"react\";import StripeCheckout from\"react-stripe-checkout\";import Modal from\"../UI/Modal\";import CartItem from\"./CartItem\";import classes from\"./Cart.module.css\";import CartContext from\"../../store/cart-context\";import Checkout from\"./Checkout\";import{CircularProgress}from\"@material-ui/core\";import Albert from\"../../assets/albert.jpeg\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var KEY=process.env.REACT_APP_STRIPE;var Cart=function Cart(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isCheckout=_useState2[0],setIsCheckout=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isSubmitting=_useState4[0],setIsSubmitting=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),didSubmit=_useState6[0],setDidSubmit=_useState6[1];var cartCtx=useContext(CartContext);var totalAmount=\"\\u20A6 \".concat(cartCtx.totalAmount.toFixed(2));var hasItems=cartCtx.items.length>0;var cartItemRemoveHandler=function cartItemRemoveHandler(id){cartCtx.removeItem(id);};var cartItemAddHandler=function cartItemAddHandler(item){cartCtx.addItem(item);};var separator=function separator(amt){var str=amt.toString().split(\".\");str[0]=str[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g,\",\");return str.join(\".\");};var submitOrderHandler=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(userData){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsSubmitting(true);_context.next=3;return fetch(\"https://react-http-req-925f9-default-rtdb.firebaseio.com/orders.json\",{method:\"POST\",body:JSON.stringify({user:userData,orderedItems:cartCtx.items})});case 3:setIsSubmitting(false);setDidSubmit(true);cartCtx.clearCart();case 6:case\"end\":return _context.stop();}}},_callee);}));return function submitOrderHandler(_x){return _ref.apply(this,arguments);};}();var orderHandler=function orderHandler(){setIsCheckout(true);};var isSubmittingModalContent=/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(CircularProgress,{})});var didSubmitModalContent=/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{className:classes.success,children:\"Successfully sent the order!\"}),/*#__PURE__*/_jsx(\"p\",{className:classes.details,children:\" \\uD83D\\uDC48 Pay now or Pay on delivery \\uD83D\\uDC4B \"}),/*#__PURE__*/_jsxs(\"div\",{className:classes.buttonContainer,children:[/*#__PURE__*/_jsx(StripeCheckout,{name:\"Albert Shop\",image:Albert,billingAddress:true,shippingAddress:true,description:\"Enter Your Payment Info Below.\",amount:100*100,stripeKey:KEY,children:/*#__PURE__*/_jsx(\"div\",{className:classes.actions,children:/*#__PURE__*/_jsx(\"button\",{className:classes.button,children:\"Pay\"})})}),/*#__PURE__*/_jsx(\"div\",{className:classes.actions,children:/*#__PURE__*/_jsx(\"button\",{className:classes.button,onClick:props.onClose,children:\"Close\"})})]})]});var cartItems=/*#__PURE__*/_jsx(\"ul\",{className:classes[\"cart-items\"],children:cartCtx.items.map(function(item){return/*#__PURE__*/_jsx(CartItem,{name:item.name,amount:item.amount,price:item.price,onRemove:cartItemRemoveHandler.bind(null,item.id),onAdd:cartItemAddHandler.bind(null,item)},item.id);})});var cartModalContent=/*#__PURE__*/_jsxs(Fragment,{children:[cartItems,/*#__PURE__*/_jsxs(\"div\",{className:classes.total,children:[/*#__PURE__*/_jsx(\"span\",{children:\"Total Amount\"}),/*#__PURE__*/_jsx(\"span\",{children:separator(totalAmount)})]}),isCheckout&&/*#__PURE__*/_jsx(Checkout,{onConfirm:submitOrderHandler,closeCheckout:props.onClose,totalPrice:totalAmount}),!isCheckout&&/*#__PURE__*/_jsxs(\"div\",{className:classes.actions,children:[!hasItems&&/*#__PURE__*/_jsxs(\"p\",{className:classes.add,children:[\" \",\"Make Sure You Add Item(s) To The Cart.\"]}),/*#__PURE__*/_jsx(\"button\",{className:classes[\"button--alt\"],onClick:props.onClose,children:\"Close\"}),hasItems&&/*#__PURE__*/_jsx(\"button\",{className:classes.button,onClick:orderHandler,children:\"Order\"})]})]});return/*#__PURE__*/_jsxs(Modal,{onClose:props.onClose,children:[!isSubmitting&&!didSubmit&&cartModalContent,isSubmitting&&isSubmittingModalContent,!isSubmitting&&didSubmit&&didSubmitModalContent]});};export default Cart;","map":{"version":3,"names":["Fragment","useContext","useState","StripeCheckout","Modal","CartItem","classes","CartContext","Checkout","CircularProgress","Albert","KEY","process","env","REACT_APP_STRIPE","Cart","props","isCheckout","setIsCheckout","isSubmitting","setIsSubmitting","didSubmit","setDidSubmit","cartCtx","totalAmount","toFixed","hasItems","items","length","cartItemRemoveHandler","id","removeItem","cartItemAddHandler","item","addItem","separator","amt","str","toString","split","replace","join","submitOrderHandler","userData","fetch","method","body","JSON","stringify","user","orderedItems","clearCart","orderHandler","isSubmittingModalContent","didSubmitModalContent","success","details","buttonContainer","actions","button","onClose","cartItems","map","name","amount","price","bind","cartModalContent","total","add"],"sources":["/home/albert/Desktop/combine-project/react-authentication/src/components/Cart/Cart.js"],"sourcesContent":["import { Fragment, useContext, useState } from \"react\";\nimport StripeCheckout from \"react-stripe-checkout\";\nimport Modal from \"../UI/Modal\";\nimport CartItem from \"./CartItem\";\nimport classes from \"./Cart.module.css\";\nimport CartContext from \"../../store/cart-context\";\nimport Checkout from \"./Checkout\";\nimport { CircularProgress } from \"@material-ui/core\";\nimport Albert from \"../../assets/albert.jpeg\"\n\nconst KEY = process.env.REACT_APP_STRIPE;\n\nconst Cart = (props) => {\n  const [isCheckout, setIsCheckout] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [didSubmit, setDidSubmit] = useState(false);\n\n  const cartCtx = useContext(CartContext);\n\n  const totalAmount = `â‚¦ ${cartCtx.totalAmount.toFixed(2)}`;\n  const hasItems = cartCtx.items.length > 0;\n\n  const cartItemRemoveHandler = (id) => {\n    cartCtx.removeItem(id);\n  };\n\n  const cartItemAddHandler = (item) => {\n    cartCtx.addItem(item);\n  };\n\n  const separator = (amt) => {\n    var str = amt.toString().split(\".\");\n    str[0] = str[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n    return str.join(\".\");\n  };\n\n  const submitOrderHandler = async (userData) => {\n    setIsSubmitting(true);\n    await fetch(\n      \"https://react-http-req-925f9-default-rtdb.firebaseio.com/orders.json\",\n      {\n        method: \"POST\",\n        body: JSON.stringify({\n          user: userData,\n          orderedItems: cartCtx.items,\n        }),\n      }\n    );\n    setIsSubmitting(false);\n    setDidSubmit(true);\n    cartCtx.clearCart();\n  };\n\n  const orderHandler = () => {\n    setIsCheckout(true);\n  };\n\n  const isSubmittingModalContent = (\n    <p>\n      <CircularProgress />\n    </p>\n  );\n\n  const didSubmitModalContent = (\n    <Fragment>\n      <p className={classes.success}>Successfully sent the order!</p>\n      <p className={classes.details}> ðŸ‘ˆ Pay now or Pay on delivery ðŸ‘‹ </p>\n      <div className={classes.buttonContainer}>\n        <StripeCheckout\n          name=\"Albert Shop\"\n          image={Albert}\n          billingAddress\n          shippingAddress\n          description=\"Enter Your Payment Info Below.\"\n          amount={100 * 100}\n          stripeKey={KEY}\n        >\n          <div className={classes.actions}>\n            <button className={classes.button}>Pay</button>\n          </div>\n        </StripeCheckout>\n        <div className={classes.actions}>\n          <button className={classes.button} onClick={props.onClose}>\n            Close\n          </button>\n        </div>\n      </div>\n    </Fragment>\n  );\n\n  const cartItems = (\n    <ul className={classes[\"cart-items\"]}>\n      {cartCtx.items.map((item) => (\n        <CartItem\n          key={item.id}\n          name={item.name}\n          amount={item.amount}\n          price={item.price}\n          onRemove={cartItemRemoveHandler.bind(null, item.id)}\n          onAdd={cartItemAddHandler.bind(null, item)}\n        />\n      ))}\n    </ul>\n  );\n\n  const cartModalContent = (\n    <Fragment>\n      {cartItems}\n      <div className={classes.total}>\n        <span>Total Amount</span>\n        <span>{separator(totalAmount)}</span>\n      </div>\n      {isCheckout && (\n        <Checkout\n          onConfirm={submitOrderHandler}\n          closeCheckout={props.onClose}\n          totalPrice={totalAmount}\n        />\n      )}\n      {!isCheckout && (\n        <div className={classes.actions}>\n          {!hasItems && (\n            <p className={classes.add}>\n              {\" \"}\n              Make Sure You Add Item(s) To The Cart.\n            </p>\n          )}\n          <button className={classes[\"button--alt\"]} onClick={props.onClose}>\n            Close\n          </button>\n          {hasItems && (\n            <button className={classes.button} onClick={orderHandler}>\n              Order\n            </button>\n          )}\n        </div>\n      )}\n    </Fragment>\n  );\n\n  return (\n    <Modal onClose={props.onClose}>\n      {!isSubmitting && !didSubmit && cartModalContent}\n      {isSubmitting && isSubmittingModalContent}\n      {!isSubmitting && didSubmit && didSubmitModalContent}\n    </Modal>\n  );\n};\n\nexport default Cart;\n"],"mappings":"6bAAA,OAASA,QAAT,CAAmBC,UAAnB,CAA+BC,QAA/B,KAA+C,OAA/C,CACA,MAAOC,eAAP,KAA2B,uBAA3B,CACA,MAAOC,MAAP,KAAkB,aAAlB,CACA,MAAOC,SAAP,KAAqB,YAArB,CACA,MAAOC,QAAP,KAAoB,mBAApB,CACA,MAAOC,YAAP,KAAwB,0BAAxB,CACA,MAAOC,SAAP,KAAqB,YAArB,CACA,OAASC,gBAAT,KAAiC,mBAAjC,CACA,MAAOC,OAAP,KAAmB,0BAAnB,C,wFAEA,GAAMC,IAAG,CAAGC,OAAO,CAACC,GAAR,CAAYC,gBAAxB,CAEA,GAAMC,KAAI,CAAG,QAAPA,KAAO,CAACC,KAAD,CAAW,CACtB,cAAoCd,QAAQ,CAAC,KAAD,CAA5C,wCAAOe,UAAP,eAAmBC,aAAnB,eACA,eAAwChB,QAAQ,CAAC,KAAD,CAAhD,yCAAOiB,YAAP,eAAqBC,eAArB,eACA,eAAkClB,QAAQ,CAAC,KAAD,CAA1C,yCAAOmB,SAAP,eAAkBC,YAAlB,eAEA,GAAMC,QAAO,CAAGtB,UAAU,CAACM,WAAD,CAA1B,CAEA,GAAMiB,YAAW,kBAAQD,OAAO,CAACC,WAAR,CAAoBC,OAApB,CAA4B,CAA5B,CAAR,CAAjB,CACA,GAAMC,SAAQ,CAAGH,OAAO,CAACI,KAAR,CAAcC,MAAd,CAAuB,CAAxC,CAEA,GAAMC,sBAAqB,CAAG,QAAxBA,sBAAwB,CAACC,EAAD,CAAQ,CACpCP,OAAO,CAACQ,UAAR,CAAmBD,EAAnB,EACD,CAFD,CAIA,GAAME,mBAAkB,CAAG,QAArBA,mBAAqB,CAACC,IAAD,CAAU,CACnCV,OAAO,CAACW,OAAR,CAAgBD,IAAhB,EACD,CAFD,CAIA,GAAME,UAAS,CAAG,QAAZA,UAAY,CAACC,GAAD,CAAS,CACzB,GAAIC,IAAG,CAAGD,GAAG,CAACE,QAAJ,GAAeC,KAAf,CAAqB,GAArB,CAAV,CACAF,GAAG,CAAC,CAAD,CAAH,CAASA,GAAG,CAAC,CAAD,CAAH,CAAOG,OAAP,CAAe,uBAAf,CAAwC,GAAxC,CAAT,CACA,MAAOH,IAAG,CAACI,IAAJ,CAAS,GAAT,CAAP,CACD,CAJD,CAMA,GAAMC,mBAAkB,4FAAG,iBAAOC,QAAP,oHACzBvB,eAAe,CAAC,IAAD,CAAf,CADyB,sBAEnBwB,MAAK,CACT,sEADS,CAET,CACEC,MAAM,CAAE,MADV,CAEEC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,CACnBC,IAAI,CAAEN,QADa,CAEnBO,YAAY,CAAE3B,OAAO,CAACI,KAFH,CAAf,CAFR,CAFS,CAFc,QAYzBP,eAAe,CAAC,KAAD,CAAf,CACAE,YAAY,CAAC,IAAD,CAAZ,CACAC,OAAO,CAAC4B,SAAR,GAdyB,sDAAH,kBAAlBT,mBAAkB,4CAAxB,CAiBA,GAAMU,aAAY,CAAG,QAAfA,aAAe,EAAM,CACzBlC,aAAa,CAAC,IAAD,CAAb,CACD,CAFD,CAIA,GAAMmC,yBAAwB,cAC5B,gCACE,KAAC,gBAAD,IADF,EADF,CAMA,GAAMC,sBAAqB,cACzB,MAAC,QAAD,yBACE,UAAG,SAAS,CAAEhD,OAAO,CAACiD,OAAtB,0CADF,cAEE,UAAG,SAAS,CAAEjD,OAAO,CAACkD,OAAtB,oEAFF,cAGE,aAAK,SAAS,CAAElD,OAAO,CAACmD,eAAxB,wBACE,KAAC,cAAD,EACE,IAAI,CAAC,aADP,CAEE,KAAK,CAAE/C,MAFT,CAGE,cAAc,KAHhB,CAIE,eAAe,KAJjB,CAKE,WAAW,CAAC,gCALd,CAME,MAAM,CAAE,IAAM,GANhB,CAOE,SAAS,CAAEC,GAPb,uBASE,YAAK,SAAS,CAAEL,OAAO,CAACoD,OAAxB,uBACE,eAAQ,SAAS,CAAEpD,OAAO,CAACqD,MAA3B,iBADF,EATF,EADF,cAcE,YAAK,SAAS,CAAErD,OAAO,CAACoD,OAAxB,uBACE,eAAQ,SAAS,CAAEpD,OAAO,CAACqD,MAA3B,CAAmC,OAAO,CAAE3C,KAAK,CAAC4C,OAAlD,mBADF,EAdF,GAHF,GADF,CA2BA,GAAMC,UAAS,cACb,WAAI,SAAS,CAAEvD,OAAO,CAAC,YAAD,CAAtB,UACGiB,OAAO,CAACI,KAAR,CAAcmC,GAAd,CAAkB,SAAC7B,IAAD,qBACjB,KAAC,QAAD,EAEE,IAAI,CAAEA,IAAI,CAAC8B,IAFb,CAGE,MAAM,CAAE9B,IAAI,CAAC+B,MAHf,CAIE,KAAK,CAAE/B,IAAI,CAACgC,KAJd,CAKE,QAAQ,CAAEpC,qBAAqB,CAACqC,IAAtB,CAA2B,IAA3B,CAAiCjC,IAAI,CAACH,EAAtC,CALZ,CAME,KAAK,CAAEE,kBAAkB,CAACkC,IAAnB,CAAwB,IAAxB,CAA8BjC,IAA9B,CANT,EACOA,IAAI,CAACH,EADZ,CADiB,EAAlB,CADH,EADF,CAeA,GAAMqC,iBAAgB,cACpB,MAAC,QAAD,YACGN,SADH,cAEE,aAAK,SAAS,CAAEvD,OAAO,CAAC8D,KAAxB,wBACE,sCADF,cAEE,sBAAOjC,SAAS,CAACX,WAAD,CAAhB,EAFF,GAFF,CAMGP,UAAU,eACT,KAAC,QAAD,EACE,SAAS,CAAEyB,kBADb,CAEE,aAAa,CAAE1B,KAAK,CAAC4C,OAFvB,CAGE,UAAU,CAAEpC,WAHd,EAPJ,CAaG,CAACP,UAAD,eACC,aAAK,SAAS,CAAEX,OAAO,CAACoD,OAAxB,WACG,CAAChC,QAAD,eACC,WAAG,SAAS,CAAEpB,OAAO,CAAC+D,GAAtB,WACG,GADH,4CAFJ,cAOE,eAAQ,SAAS,CAAE/D,OAAO,CAAC,aAAD,CAA1B,CAA2C,OAAO,CAAEU,KAAK,CAAC4C,OAA1D,mBAPF,CAUGlC,QAAQ,eACP,eAAQ,SAAS,CAAEpB,OAAO,CAACqD,MAA3B,CAAmC,OAAO,CAAEP,YAA5C,mBAXJ,GAdJ,GADF,CAmCA,mBACE,MAAC,KAAD,EAAO,OAAO,CAAEpC,KAAK,CAAC4C,OAAtB,WACG,CAACzC,YAAD,EAAiB,CAACE,SAAlB,EAA+B8C,gBADlC,CAEGhD,YAAY,EAAIkC,wBAFnB,CAGG,CAAClC,YAAD,EAAiBE,SAAjB,EAA8BiC,qBAHjC,GADF,CAOD,CAvID,CAyIA,cAAevC,KAAf"},"metadata":{},"sourceType":"module"}